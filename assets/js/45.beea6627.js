(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{283:function(s,e,a){"use strict";a.r(e);var n=a(0),r=Object(n.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"linux-部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#linux-部署"}},[s._v("#")]),s._v(" Linux 部署")]),s._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#java"}},[s._v("java")])]),a("li",[a("a",{attrs:{href:"#redis"}},[s._v("redis")])]),a("li",[a("a",{attrs:{href:"#nginx"}},[s._v("nginx")])]),a("li",[a("a",{attrs:{href:"#zookeeper"}},[s._v("zookeeper")])]),a("li",[a("a",{attrs:{href:"#mysql"}},[s._v("mysql")])])])]),a("p"),s._v(" "),a("h2",{attrs:{id:"java"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#java"}},[s._v("#")]),s._v(" java")]),s._v(" "),a("p",[s._v("1.复制压缩包到一个目录下，例如：cp jdk.tar.gz /usr/local/")]),s._v(" "),a("p",[s._v("2.解压缩，例如：tar xvf jdk.tar.gz")]),s._v(" "),a("p",[s._v("3.建立软连接，例如：ln -s jdk1.7.0_67 jdk")]),s._v(" "),a("p",[s._v("4.编辑系统文件，"),a("code",[s._v("vim /etc/profile")]),s._v("，添加内容如下")]),s._v(" "),a("div",{staticClass:"language-markdown line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-markdown"}},[a("code",[s._v("      export JAVA"),a("span",{pre:!0,attrs:{class:"token italic"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("_")]),a("span",{pre:!0,attrs:{class:"token content"}},[s._v("HOME=/usr/local/jdk\n      export CLASSPATH=$CLASSPATH:$JAVA")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("_")])]),s._v("HOME/lib:$JAVA"),a("span",{pre:!0,attrs:{class:"token italic"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("_")]),a("span",{pre:!0,attrs:{class:"token content"}},[s._v("HOME/jre/lib\n      export PATH=$PATH:$JAVA")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("_")])]),s._v("HOME/bin\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("5.使文件生效，"),a("code",[s._v("source /etc/profile")])]),s._v(" "),a("p",[s._v("6."),a("code",[s._v("java -version")])]),s._v(" "),a("h2",{attrs:{id:"redis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis"}},[s._v("#")]),s._v(" redis")]),s._v(" "),a("ol",[a("li")]),s._v(" "),a("p",[s._v("redis下载地址:也可以直接下载到服务器："),a("code",[s._v("wget http://download.redis.io/releases/redis-4.0.11.tar.g")])]),s._v(" "),a("p",[s._v("或者 "),a("code",[s._v("rz 选择tar包文件")])]),s._v(" "),a("p",[s._v("2.解压缩，例如："),a("code",[s._v("tar -zxvf redis-3.2.1.tar.gz")])]),s._v(" "),a("p",[s._v("3.建立软连接，例如："),a("code",[s._v("ln -s redis-3.2.1 redis")])]),s._v(" "),a("p",[s._v("4.在redis目录下执行安装命令，如下：")]),s._v(" "),a("p",[a("code",[s._v("cd /usr/local/redis")])]),s._v(" "),a("p",[a("code",[s._v("make PREFIX=/usr/local/redis install")])]),s._v(" "),a("p",[s._v("5.在/etc目录下创建redis目录，mkdir /etc/redis")]),s._v(" "),a("p",[s._v("6.在/etc/redis目录下创建redis配置文件，例如：6384.conf，其中有一些重要属性需要修改，如下：")]),s._v(" "),a("div",{staticClass:"language-markdown line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-markdown"}},[a("code",[s._v('      port 6384 端口号，最好和配置名称对应\n      bind 0.0.0.0 允许访问的ip地址，0.0.0.0允许所有ip访问\n      databases 1 创建数据库，目前是一块\n      save "" 存储磁盘位置，不设置则不存盘\n      dir /data/redis/6384/ 设置一个工作磁盘目录s\n      \txxxx 设置密码，用于登陆\n      maxmemory 512mb 最大占用内存单位mb，gb\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("7.在/etc/init.d/目录下创建redis启动文件，其中有一些重要属性，如下：")]),s._v(" "),a("div",{staticClass:"language-markdown line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-markdown"}},[a("code",[s._v('      case 中的条件，如youhuipai，这个是启动redis别名，可以自行设置任意名称\n      REDISPORT=6384 占用的端口号，等于redis配置中的port值\n      REDISPASS="xxxx" 登陆密码，等于redis配置文件中的requirepass值\n      EXEC=/usr/local/redis/bin/redis-server 执行redis服务端命令的位置\n      CLIEXEC=/usr/local/redis/bin/redis-cli 执行redis客户端命令的位置\n      PIDFILE=/var/run/redis_${REDISPORT}.pid redis进程号存放位置\n      CONF="/etc/redis/${REDISPORT}.conf" redis配置文件位置\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("创建完成需要更好执行权限，"),a("code",[s._v("chmod 777 redis")])]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#!/bin/sh\n# chkconfig: 2345 80 90\n#\n# Simple Redis init.d script conceived to work on Linux systems\n# as it does use of the /proc filesystem.\n\n\nREDISPORT=6379\ncase "$2" in\n    1)\n\tREDISPORT=6384\n\tREDISPASS="Queke123!!!"\n\t;;\n    *)\n\techo "Please use youhuipai as second argument"\n\texit 1\n        ;;\nesac\n\n\nEXEC=/usr/local/redis/bin/redis-server\nCLIEXEC=/usr/local/redis/bin/redis-cli\n\nPIDFILE=/var/run/redis_${REDISPORT}.pid\nCONF="/etc/redis/${REDISPORT}.conf"\n\ncase "$1" in\n    start)\n        if [ -f $PIDFILE ]\n        then\n                echo "$PIDFILE exists, process is already running or crashed"\n        else\n                echo "Starting Redis server..."\n                $EXEC $CONF &\n        fi\n        ;;\n    stop)\n        if [ ! -f $PIDFILE ]\n        then\n                echo "$PIDFILE does not exist, process is not running"\n        else\n                PID=$(cat $PIDFILE)\n                echo "Stopping ..."\n                $CLIEXEC -p $REDISPORT -a $REDISPASS shutdown\n                while [ -x /proc/${PID} ]\n                do\n                    echo "Waiting for Redis to shutdown ..."\n                    sleep 1\n                done\n                echo "Redis stopped"\n        fi\n        ;;\n    *)\n        echo "Please use start or stop as first argument"\n        ;;\nesac\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br")])]),a("p",[s._v("8.启动redis命令，service redis start xxxx，其中xxxx对应redis启动文件case中的别名")]),s._v(" "),a("p",[s._v("9.关闭redis命令，service redis stop xxxx")]),s._v(" "),a("ul",[a("li",[s._v("启动&查看")])]),s._v(" "),a("p",[a("code",[s._v("ps -ef | grep redis")])]),s._v(" "),a("p",[a("code",[s._v("./redis-server /etc/redis/6379.conf")])]),s._v(" "),a("p",[a("code",[s._v("./redis-cli -h 127.0.0.1 -p 6379")])]),s._v(" "),a("p",[a("code",[s._v("auth 密码")])]),s._v(" "),a("ul",[a("li",[s._v("卸载")])]),s._v(" "),a("div",{staticClass:"language-markdown line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-markdown"}},[a("code",[a("span",{pre:!0,attrs:{class:"token title important"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("#")]),s._v("查看进程")]),s._v("\nps aux |grep redis\n"),a("span",{pre:!0,attrs:{class:"token title important"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("#")]),s._v("杀掉进程")]),s._v("\nkill -9 进程号\n"),a("span",{pre:!0,attrs:{class:"token title important"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("#")]),s._v("查看相关文件")]),s._v('\nfind / -name "redis"\n'),a("span",{pre:!0,attrs:{class:"token title important"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("#")]),s._v("删除文件")]),s._v("\nrm -rf 文件\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h2",{attrs:{id:"nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx"}},[s._v("#")]),s._v(" nginx")]),s._v(" "),a("p",[s._v("1.安装make\n"),a("code",[s._v("yum -y install gcc automake autoconf libtool make")])]),s._v(" "),a("p",[a("code",[s._v("yum install gcc gcc-c++")])]),s._v(" "),a("p",[s._v("2.安装pcre\n"),a("code",[s._v("cd /usr/local/src")]),s._v("    //进入src目录")]),s._v(" "),a("p",[a("code",[s._v("wget ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/pcre-8.39.tar.gz")]),s._v("    //下载pcre库")]),s._v(" "),a("p",[a("code",[s._v("tar -zxvf pcre-8.39.tar.gz")]),s._v("  //解压")]),s._v(" "),a("p",[a("code",[s._v("cd pcre-8.39")])]),s._v(" "),a("p",[a("code",[s._v("./configure")])]),s._v(" "),a("p",[a("code",[s._v("make && make install")])]),s._v(" "),a("p",[s._v("3.安装zlib")]),s._v(" "),a("p",[a("code",[s._v("cd /usr/local/src")]),s._v("      //进入src目录")]),s._v(" "),a("p",[a("code",[s._v("wget http://zlib.net/zlib-1.2.11.tar.gz")]),s._v("     //下载zlib库")]),s._v(" "),a("p",[a("code",[s._v("tar -zxvf zlib-1.2.11.tar.gz")])]),s._v(" "),a("p",[a("code",[s._v("cd zlib-1.2.11")])]),s._v(" "),a("p",[a("code",[s._v("./configure")])]),s._v(" "),a("p",[a("code",[s._v("make && make install")])]),s._v(" "),a("p",[s._v("4.安装openssl")]),s._v(" "),a("p",[a("code",[s._v("cd /usr/local/src")])]),s._v(" "),a("p",[a("code",[s._v("wget https://www.openssl.org/source/openssl-1.0.1t.tar.gz")])]),s._v(" "),a("p",[a("code",[s._v("tar -zxvf openssl-1.0.1t.tar.gz")])]),s._v(" "),a("p",[a("code",[s._v("./config && make && make install")])]),s._v(" "),a("p",[s._v("5.安装nginx")]),s._v(" "),a("p",[s._v("cd /usr/local/src")]),s._v(" "),a("p",[a("code",[s._v("wget http://nginx.org/download/nginx-1.1.10.tar.gz")])]),s._v(" "),a("p",[a("code",[s._v("tar -zxvf nginx-1.1.10.tar.gz")])]),s._v(" "),a("p",[a("code",[s._v("cd nginx-1.1.10")])]),s._v(" "),a("p",[a("code",[s._v("./configure")])]),s._v(" "),a("p",[a("code",[s._v("make && make install")])]),s._v(" "),a("p",[s._v("nginx启动命令:")]),s._v(" "),a("p",[a("code",[s._v("/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf")]),s._v(" 或\n进入 sbin目录  执行"),a("code",[s._v("./nginx")])]),s._v(" "),a("p",[s._v("查看 nginx 进程：")]),s._v(" "),a("p",[a("code",[s._v("ps aux|grep nginx")])]),s._v(" "),a("p",[s._v("启动失败:")]),s._v(" "),a("p",[a("code",[s._v("ln -s /usr/local/lib/libpcre.so.1 /lib")])]),s._v(" "),a("p",[s._v("停止")]),s._v(" "),a("p",[a("code",[s._v("./nginx -s quit")])]),s._v(" "),a("p",[s._v("开放80端口"),a("code",[s._v("firewall-cmd --zone=public --add-port=80/tcp --permanent")])]),s._v(" "),a("p",[s._v("停止防火墙"),a("code",[s._v("systemctl stop firewalld.service")])]),s._v(" "),a("p",[s._v("启动防火墙"),a("code",[s._v("systemctl start firewalld.service")])]),s._v(" "),a("h2",{attrs:{id:"zookeeper"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper"}},[s._v("#")]),s._v(" zookeeper")]),s._v(" "),a("p",[s._v("1.cd /usr/local/")]),s._v(" "),a("p",[s._v("2.上传压缩包")]),s._v(" "),a("p",[s._v("rz  选择压缩包")]),s._v(" "),a("p",[s._v("3."),a("code",[s._v("tar -zxvf zookeeper-3.4.10.tar.gz")])]),s._v(" "),a("p",[s._v("4."),a("code",[s._v("ln -s zookeeper-3.4.10 zookeeper")])]),s._v(" "),a("p",[s._v("5.配置环境变量")]),s._v(" "),a("p",[a("code",[s._v("vim /etc/profile")])]),s._v(" "),a("p",[a("code",[s._v("export ZOO_HOME=/usr/local/zookeeper")])]),s._v(" "),a("p",[a("code",[s._v("export PATH=$PATH:$ZOO_HOME/bin")])]),s._v(" "),a("p",[s._v("6.使/etc/profile生效  ："),a("code",[s._v("source /etc/profile")])]),s._v(" "),a("p",[s._v("7."),a("code",[s._v("cd /usr/local/zookeeper")])]),s._v(" "),a("p",[a("code",[s._v("zkServer.sh start")]),s._v("  //启动zookeeper")]),s._v(" "),a("p",[a("code",[s._v("netstat -lntp | grep java")]),s._v("  # 检查端口是否有正常监听")]),s._v(" "),a("p",[a("code",[s._v("zkServer.sh status")]),s._v("  # 查看zookeeper服务状态")]),s._v(" "),a("p",[a("code",[s._v("ps aux |grep java")]),s._v("  # 检查服务进程")]),s._v(" "),a("p",[s._v("8.关闭 zookeeper")]),s._v(" "),a("p",[a("code",[s._v("zkServer.sh stop")])]),s._v(" "),a("p",[s._v("zoo.cfg配置：")]),s._v(" "),a("pre",[a("code",[s._v("tickTime：用于计算的时间单元。比如session超时：N * tickTime\ninitLimit：用于集群，允许从节点连接并同步到master节点的初始化连接时间，以tickTime的倍数来表示\nsyncLimit：用于集群，master主节点与从节点之间发送消息，请求和应答时间长度（心跳包机制）\ndataDir：必须配置，数据文件所存放的目录\ndataLogDir：日志目录，如果不配置就和dataDir共用同一个目录\nclientPort：连接服务器的端口，默认为2181\n")])]),s._v(" "),a("p",[s._v("调试："),a("code",[s._v("./zkServer.sh start-foreground")])]),s._v(" "),a("h2",{attrs:{id:"mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql"}},[s._v("#")]),s._v(" mysql")]),s._v(" "),a("p",[s._v("1.复制压缩包到一个目录下，例如："),a("code",[s._v("cp mysql-5.5.45-linux2.6-x86_64.tar.gz /usr/local/")])]),s._v(" "),a("p",[s._v("2.解压缩，例如："),a("code",[s._v("tar xvf mysql-5.5.45-linux2.6-x86_64.tar.gz")])]),s._v(" "),a("p",[s._v("3.建立软连接，例如："),a("code",[s._v("ln -s mysql-5.5.45-linux2.6-x86_64 mysql")])]),s._v(" "),a("p",[s._v("4.编辑系统文件，"),a("code",[s._v("vim /etc/profile")]),s._v("，添加内容如下")]),s._v(" "),a("pre",[a("code",[s._v("  export MYSQL_HOME=/usr/local/mysql\n  export PATH=$PATH:$MYSQL_HOME/bin\n")])]),s._v(" "),a("p",[s._v("5.使文件生效，"),a("code",[s._v("source /etc/profile")])]),s._v(" "),a("p",[s._v("6.编辑mysql配置文件，文件目录"),a("code",[s._v("/etc/my.cnf")]),s._v("，其中有些重要属性，")]),s._v(" "),a("div",{staticClass:"language-markdown line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-markdown"}},[a("code",[s._v("      datadir 这个是数据库存储目录\n      log 这个是日志目录\n      pid-file 进程号存储目录\n      socket 登陆需要的信息存储位置\n      server-id 用于在一台服务器启动多个mysql实例的服务号，不能重复\n      binlog-ignore-db 主从同步属性，配置到主mysql属性中，binlog不需要同步的数据库名称\n      binlog-do-db 主从同步属性，配置到主mysql属性9中，binlog需要同步的数据库名称\n      replicate-ignore-db 主从同步属性，配置到从mysql属性中，binlog不需要同步的数据库名称   \n      replicate-do-db 主从同步属性，配置到从mysql属性中，binlog需要同步的数据库名称\n      log-error 启动错误日志位置\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("7.安装初始化库，在script目录下执行："),a("code",[s._v("./mysql_install_db --user=root --basedir=/usr/local/mysql --datadir=/data/mysql/master")])]),s._v(" "),a("p",[s._v("8.启动mysql主从服务，"),a("code",[s._v("mysqld_multi start 1")]),s._v(" 和 "),a("code",[s._v("mysqld_multi start 2")]),s._v("，其中1，2是配置中的server-id")]),s._v(" "),a("p",[s._v("9.分别登陆mysql, "),a("code",[s._v("mysql -h 127.0.0.1 -uroot")]),s._v(","),a("code",[s._v("mysql -S /tmp/mysql.sock1")]),s._v("， -S的内容是配置中的socket")]),s._v(" "),a("p",[s._v("10.设置登陆权限，"),a("code",[s._v("grant all PRIVILEGES on *.* to root@'%' identified by 'root123'")]),s._v("; //外网连接密码")]),s._v(" "),a("p",[s._v("11.刷新权限，"),a("code",[s._v("flush privileges")]),s._v(";")]),s._v(" "),a("p",[s._v("12.关闭数据库，"),a("code",[s._v("mysqld_multi stop 1")]),s._v("，在"),a("code",[s._v("/etc/my.cnf")]),s._v("中把"),a("code",[s._v("/etc/my.cnf")]),s._v("下注掉的#user和#password打开。//内网连接")]),s._v(" "),a("p",[s._v("13.启动数据库，"),a("code",[s._v("mysqld_multi start 1")]),s._v("，执行"),a("code",[s._v("mysqladmin -u root password Queke123 -S /tmp/mysql.sock1")]),s._v("，注意这些密码必须是一样的。")]),s._v(" "),a("p",[s._v("14.本地登陆mysql命令改为，"),a("code",[s._v("mysql -uroot -pQueke123 -S /tmp/mysql.sock1")]),s._v(",安装完毕。下面是主从的配置，可以不看。")]),s._v(" "),a("p",[s._v("15.登陆主mysql设置主从同步账号，"),a("code",[s._v("GRANT REPLICATION SLAVE ON *.* TO 'backup'@'localhost' IDENTIFIED BY 'backup123'")])]),s._v(" "),a("p",[s._v("16.在主mysql中查询binlog信息，"),a("code",[s._v("show master status")]),s._v("，其中File属性就是binlog名称，Position是需要开始同步位置，这两个属性是需要记住的")]),s._v(" "),a("p",[s._v("17.登陆从mysql关闭从同步，stop slave")]),s._v(" "),a("p",[s._v("18.在从mysql中配置从同步信息，"),a("code",[s._v("change master to master_host='127.0.0.1', master_user='backup', master_password='backup123'")]),s._v(",\n"),a("code",[s._v("master_log_file='mysql-bin.000005', master_log_pos=142")]),s._v("，其中master_log_file和master_log_pos就是主mysql查到的binlog信息")]),s._v(" "),a("p",[s._v("19.在从mysql开启从同步，start slave")]),s._v(" "),a("p",[s._v("20.关闭数据库命令，"),a("code",[s._v("mysqld_multi stop 1")]),s._v(" 和 "),a("code",[s._v("mysqld_multi stop 2")])]),s._v(" "),a("p",[s._v("21.mysql备份，通过crontab -e")]),s._v(" "),a("pre",[a("code",[s._v(" 输入0 0 * * * /usr/local/shell/mysql-backup.sh >> /data/mysql_backup/mylog.log 2>&1\n 脚本是mysql-backup.sh \n")])]),s._v(" "),a("p",[s._v("给脚本执行权限：cdh")]),s._v(" "),a("p",[s._v("22.slave_skip_errors = 1062 同步的时候跳过主键冲突的错误")]),s._v(" "),a("p",[s._v("//安装完成后注意事项")]),s._v(" "),a("p",[s._v("1.mysql -uroot -pQueke123 -S /tmp/mysql.sock1 为本机登录  Queke123是登录密码")]),s._v(" "),a("p",[s._v("2./etc/my.cnf 下的password 为外网连接密码")]),s._v(" "),a("p",[s._v("3.修改外网密码连接方式")]),s._v(" "),a("p",[s._v("1.本机登录")]),s._v(" "),a("p",[s._v("2.mysql>use mysql;")]),s._v(" "),a("p",[s._v("mysql> update user set password=passworD(\"test\") where user='root';")]),s._v(" "),a("p",[s._v("mysql> flush privileges;")]),s._v(" "),a("p",[s._v("mysql> exit;")]),s._v(" "),a("p",[s._v("//数据库连接错误处理")]),s._v(" "),a("p",[s._v("MySql Host is blocked because of many connection errors; unblock with 'mysqladmin flush-hosts' 解决方法")]),s._v(" "),a("p",[s._v("mysqladmin --socket=/tmp/mysql.sock1 --port=3306 -uroot -p flush-hosts")])])}),[],!1,null,null,null);e.default=r.exports}}]);